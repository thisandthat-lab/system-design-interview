# 7μ¥. νΈν…” μμ•½ μ‹μ¤ν…

# 1λ‹¨κ³„. λ¬Έμ  μ΄ν•΄ λ° μ„¤κ³„ λ²”μ„ ν™•μ •

### κΈ°λ¥ μ”κµ¬μ‚¬ν•­

- μμ•½ λ“±λ΅/μ·¨μ† κΈ°λ¥ (μ΄ λ• 10% μ¤λ²„λ¶€ν‚Ή κ°€λ¥)
- νΈν…” λ° κ°μ‹¤ μ •λ³΄ νμ΄μ§€ ν‘μ‹
- κ°μ‹¤ κ°€κ²©μ€ μ λ™μ (κ·Έ λ‚  κ°μ‹¤μ— μ—¬μ κ°€ μ–Όλ§λ‚ μλ”μ§€μ— λ”°λΌ λ³€λ™)
- νΈν…”μ΄λ‚ κ°μ‹¤ μ •λ³΄ CRUDλ¥Ό μ§€μ›ν•λ” κ΄€λ¦¬μ νμ΄μ§€ μ§€μ›

### λΉ„κΈ°λ¥ μ”κµ¬μ‚¬ν•­

- 5000κ° νΈν…”μ— 100λ§ κ° κ°μ‹¤μ„ κ°–μ¶ νΈν…” μ²΄μΈμ„ μ„ν• μ›Ήμ‚¬μ΄νΈ κµ¬μ¶•
- **λ†’μ€ μμ¤€μ λ™μ‹μ„±:** μ„±μκΈ°, λ€κ·λ¨ μ΄λ²¤νΈ κΈ°κ°„μ—λ” μΌλ¶€ μΈκΈ° νΈν…”μ νΉμ • κ°μ‹¤μ„ μμ•½ν•λ ¤λ” κ³ κ°μ΄ λ§μ΄ λ°λ¦΄ μ μμ
- **μ μ ν• μ§€μ—° μ‹κ°„**: μμ•½ μ‹ μ‘λ‹µ μ‹κ°„μ΄ λΉ λ¥΄λ©΄ μ΄μƒμ μ΄κ² μ§€λ§, μμ•½ μ”μ²­ μ²λ¦¬μ— λ‡ μ΄ μ •λ„ κ±Έλ¦¬λ” κ²ƒμ€ ν—μ©λ¨

### κ°λµμ  κ·λ¨ μ¶”μ •

- μ΄ 5,000κ° νΈν…”, 100λ§κ° κ°μ‹¤μ΄ μλ‹¤κ³  κ°€μ •
- ν‰κ· μ μΌλ΅ κ°μ‹¤μ 70%κ°€ μ‚¬μ©μ¤‘μ΄κ³ , ν‰κ·  ν¬μ™ κΈ°κ°„μ€ 3μΌμ΄λΌκ³  κ°€μ •

β†’ μΌμΌ μμƒ μμ•½ κ±΄μ = `100λ§ * 0.7 / 3 = 233,333 = **μ•½ 240,000κ±΄**`

β†’ μ΄λ‹Ή μμ•½ κ±΄μ = `240,000 / ν•λ£¨μ— 10^5μ΄ = **~3**` β‡’ TPSλ” κ·Έλ‹¤μ§€ λ†’μ§€ μ•μ

### QPS κ³„μ‚°ν•κΈ°

- μΌλ°μ μΌλ΅ κ³ κ°μ΄ μ‚¬μ©ν•λ” ν”λ΅μ°
    - μ‚¬μ©μκ°€ νΈν…”/κ°μ‹¤ μ •λ³΄λ¥Ό ν™•μΈν•λ‹¤. (**μ΅°ν λ°μƒ**)
    - μ‚¬μ©μκ°€ λ‚ μ§, ν¬μ™ μΈμ›, κ²°μ  λ°©λ²• λ“±μ μƒμ„Έ μ •λ³΄λ¥Ό ν™•μΈν•λ‹¤. (**μ΅°ν λ°μƒ**)
    - μ‚¬μ©μκ°€ β€μμ•½β€™ λ²„νΌμ„ λλ¬ κ°μ‹¤μ„ μμ•½ν•λ‹¤. (**νΈλμ­μ… λ°μƒ**)
    
    β†’ λ€λµ 10% μ‚¬μ©μκ°€ λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰ν•κ³ , 90%μ μ‚¬μ©μλ” μµμΆ… λ‹¨κ³„ λ„λ‹¬ μ „μ— νλ¦„μ„ μ΄νƒν•λ‹¤κ³  κ°€μ •
    
- λ€λµμ μΈ QPS
    - κ°μ‹¤ μƒμ„Έ νμ΄μ§€ β†’ `QPS 300`
    - μμ•½ μƒμ„Έ νμ΄μ§€ β†’ `QPS 30`
    - κ°μ‹¤ μμ•½ νμ΄μ§€ β†’ `QPS 3`

# 2λ‹¨κ³„. κ°λµμ μΈ μ„¤κ³„μ• μ μ‹ λ° λ™μ κµ¬ν•κΈ°

## API μ„¤κ³„

### νΈν…” κ΄€λ ¨ API

- **`GET` /v1/hotels/id** : νΈν…”μ μƒμ„Έ μ •λ³΄ λ°ν™
- **`POST` /v1/hotels** : μ‹ κ· νΈν…” μ¶”κ°€(μ–΄λ“λ―Όμ©)
- **`PUT` /v1/hotels/id** : νΈν…” μ •λ³΄ κ°±μ‹ (μ–΄λ“λ―Όμ©)
- **`DELETE` /v1/hotels/id** : νΈν…” μ •λ³΄ μ‚­μ (μ–΄λ“λ―Όμ©)

### κ°μ‹¤ κ΄€λ ¨ API

- **`GET` /v1/hotels/:id/rooms/id** : κ°μ‹¤ μƒμ„Έ μ •λ³΄ λ°ν™
- **`POST` /v1/hotels/:id/rooms** : μ‹ κ· κ°μ‹¤ μ¶”κ°€(μ–΄λ“λ―Όμ©)
- **`PUT` /v1/hotels/:id/rooms/id** : κ°μ‹¤ μ •λ³΄ κ°±μ‹ (μ–΄λ“λ―Όμ©)
- **`DELETE` /v1/hotels/:id/rooms/id** : κ°μ‹¤ μ •λ³΄ μ‚­μ (μ–΄λ“λ―Όμ©)

### μμ•½ κ΄€λ ¨ API

- **`GET` /v1/reservations** : λ΅κ·ΈμΈ μ‚¬μ©μμ μμ•½ μ΄λ ¥ λ°ν™
- **`GET` /v1/reservations/id** : νΉμ • μμ•½μ μƒμ„Έ μ •λ³΄ λ°ν™
- **`POST` /v1/reservations** : μ‹ κ· μμ•½
    - params μμ‹
        
        ```json
        {
        	"startDate": "2021-04-28",
        	"endDate": "2021-04-30",
        	"hotelID": "245",
        	"roomId": "U123456789",
        	"reservationID": "13422445"
        }
        ```
        
        - **reservationID**λ” μ—μ¤‘ μμ•½μ„ λ°©μ§€ν•κ³ , λ™μΌν• μμ•½μ€ ν• λ²λ§ μƒμ„±λλ„λ΅ λ³΄μ¦ν•λ” **λ©±λ“±ν‚¤**
- **`DELETE` /v1/reservations/id** : μμ•½ μ·¨μ†

## λ°μ΄ν„° λ¨λΈ

- νΈν…” μμ•½ μ‹μ¤ν…μ΄ μ§€μ›ν•΄μ•Ό ν•λ” μ§μ
    - νΈν…” μƒμ„Έ μ •λ³΄ μ΅°ν
    - μ§€μ •λ λ‚ μ§ λ²”μ„μ— μ‚¬μ© κ°€λ¥ν• κ°μ‹¤ μ ν• μ΅°ν
    - μμ•½ μ •λ³΄ κΈ°λ΅
    - μμ•½ λ‚΄μ—­ λλ” κ³Όκ±° μμ•½ μ΄λ ¥ μ •λ³΄ μ΅°ν
    
    β†’ **RDB**λ¥Ό μ„ νƒν•λ‹¤.
    

### RDB μ„ νƒ μ΄μ 

- **RDBλ” μ½κΈ° λΉλ„κ°€ μ“°κΈ° μ—°μ‚°μ— λΉ„ν•΄ λ†’μ€ μ‘μ—… νλ¦„μ„ μ μ§€μ›ν•λ‹¤.**
    - νΈν…” μ›Ήμ‚¬μ΄νΈ λ°©λ¬Έ μ‚¬μ©μ μ > κ°μ‹¤ μμ•½ν•λ” μ‚¬μ©μ μ μ΄λ―€λ΅ μ΅°ν λΉλ„κ°€ μ••λ„μ μΌλ΅ λ§λ‹¤.
    - NoSQLμ€ λ€μ²΄λ΅ μ“°κΈ° μ—°μ‚°μ— μµμ ν™”λμ–΄ μκ³ , RDBλ” μ½κΈ°κ°€ μ••λ„μ γ…‡λ‹ μ‘μ—… νλ¦„μ„ μ¶©λ¶„ν μ μ§€μ›ν•λ‹¤.
- **RDBλ” ACID(μ›μμ„±, μΌκ΄€μ„±, κ²©λ¦¬μ„±, μμ†μ„±)λ¥Ό λ³΄μ¥ν•λ‹¤.**
    - μμ•½ μ‹μ¤ν…μ—μ„ ACIDλ” μ•„μ£Ό μ¤‘μ”ν•λ‹¤.
    - RDBλ” μΌλ°μ μΌλ΅ ACID μ†μ„±μ„ λ³΄μ¥ν•λ‹¤.
- **RDBλ¥Ό μ‚¬μ©ν•λ©΄ λ°μ΄ν„°λ¥Ό μ‰½κ² λ¨λΈλ§ν•  μ μλ‹¤.**
    - λΉ„μ¦λ‹μ¤ λ°μ΄ν„°μ κµ¬μ΅°λ¥Ό λ…ν™•ν•κ² ν‘ν„ν•  μ μλ‹¤.
    - μ—”ν‹°ν‹°(νΈν…”, κ°μ‹¤, κ°μ‹¤ μ ν•) κ°„μ κ΄€κ³„λ¥Ό μ•μ •μ μΌλ΅ μ§€μ›ν•  μ μλ‹¤.

### μ¤ν‚¤λ§ μ„¤κ³„

- νΈν…” μ„λΉ„μ¤
    - **hotel** - hotel_id(PK), name, address, location
    - **room** - room_id(PK), room_type_id, floor, number, hotel_id, name, is_available
- μ”κΈ μ„λΉ„μ¤
    - **room_type_rate** - hotel_id(PK), date(PK), rate
- μμ•½ μ„λΉ„μ¤
    - **reservation** - reservation_id(PK), hotel_id, room_id, start_date, end_date, **status**, guest_id
    
    > **PENDING**(κ²°μ  λ€κΈ°), **PAID**(κ²°μ  μ™„λ£), **REFUNDED**(ν™λ¶ μ™„λ£), **CANCELED**(μ·¨μ†), **REJECTED**(μΉμΈ μ‹¤ν¨)
    
    - room_idκ°€ μμΌλ―€λ΅ μ—μ–΄λΉ„μ•¤λΉ„κ°™μ€ νμ‚¬μ—λ” μ ν•©ν• μ¤ν‚¤λ§μ΄λ‹¤.
    - νΈν…”μ κ²½μ° νΉμ • κ°μ‹¤μ΄ μ•„λ‹ νΉμ • κ°μ‹¤ μ ν•μ„ μμ•½ν•κΈ° λ•λ¬Έμ— λ¶€μ μ ν• μ¤ν‚¤λ§μ΄λ‹¤.
    > 
- ν¬μ™κ° μ„λΉ„μ¤
    - **guest** - guest_id(PK), first_name, lats_name, email

## κ°λµμ  μ„¤κ³„μ•

- **MSA**λ΅ κµ¬μ„±ν•λ‹¤.
![IMG_7700](https://github.com/thisandthat-lab/system-design-interview/assets/132281360/f669109e-e354-4942-960e-bb94cb9193bf)

- **κ³µκ° API κ²μ΄νΈμ›¨μ΄**
    - μ²λ¦¬μ¨ μ ν•, μΈμ¦ λ“±μ κΈ°λ¥μ„ μ§€μ›ν•λ” μ™„μ „ κ΄€λ¦¬ν• μ„λΉ„μ¤
    - μ—”λ“ν¬μΈνΈ κΈ°λ°μΌλ΅ νΉμ • μ„λΉ„μ¤μ— μ”μ²­ μ „λ‹¬
- **λ‚΄λ¶€ API**
    - μΉμΈλ μ μ €λ§ μ‚¬μ© κ°€λ¥ν• APIλ΅, VPN λ“±μ κΈ°μ μ„ μ‚¬μ©ν•μ—¬ μ™Έλ¶€ κ³µκ²©μΌλ΅λ¶€ν„° λ³΄νΈ
- **νΈν…” μ„λΉ„μ¤**
    - νΈν…”κ³Ό κ°μ‹¤μ— λ€ν• μƒμ„Έ μ •λ³΄ μ κ³µ (μΊμ‹±)
- **μ”κΈ μ„λΉ„μ¤**
    - κ°μ‹¤μ μ”κΈμ€ ν•΄λ‹Ή λ‚ μ§μ— νΈν…”μ— μ–Όλ§λ‚ λ§μ€ μ†λ‹μ΄ λ°λ¦¬λλƒμ— λ”°λΌ λ‹¬λΌμ§„λ‹¤.
- **μμ•½ μ„λΉ„μ¤**
    - μμ•½ μ”μ²­μ„ λ°›κ³  κ°μ‹¤μ„ μμ•½ν•λ” κ³Όμ • μ²λ¦¬
    - κ°μ‹¤μ΄ μμ•½λκ±°λ‚ μ·¨μ†λ  λ• μ”μ—¬ κ°μ‹¤ μ •λ³΄ κ°±μ‹ 
- **κ²°μ  μ„λΉ„μ¤**
    - κ²°μ κ°€ μ™„λ£λλ©΄ statusλ¥Ό PAIDλ΅ κ°±μ‹ , μ‹¤ν¨ν• κ²½μ° REJECTEDλ΅ κ°±μ‹ 
- **νΈν…” κ΄€λ¦¬ μ„λΉ„μ¤**
    - μ„λ°•ν• μμ•½ κΈ°λ΅ ν™•μΈ, κ³ κ° κ°μ‹¤ μμ•½, μμ•½ μ·¨μ† λ“±μ κΈ°λ¥ μ κ³µ

# 3λ‹¨κ³„. μƒμ„Έ μ„¤κ³„

## κ°μ„ λ λ°μ΄ν„° λ¨λΈ

### νΉμ • κ°μ‹¤μ΄ μ•„λ‹λΌ νΉμ •ν• κ°μ‹¤ μ ν•μ„ μμ•½ν•λ„λ΅ ν•κΈ°

- **request parameter λ³€κ²½**
    
    ```json
    {
    	"startDate": "2021-04-28",
    	"endDate": "2021-04-30",
    	"hotelID": "245",
    	"roomTypeID": "U123456789",
    	"reservationID": "13422445"
    }
    ```
    
    - AS-IS : roomID
    - TO-BE : roomTypeID
- **μ¤ν‚¤λ§ λ³€κ²½**
    - AS-IS
        - **room** - room_id(PK), room_type_id, floor, number, hotel_id, name, is_available
        - **reservation** - reservation_id(PK), hotel_id, room_id, start_date, end_date, status, guest_id
    - TO-BE
        - **room** - room_id(PK), room_type_id, floor, number, hotel_id, name, is_available
        - **room_type_inventory** - **hotel_id, room_type_id, date**, total_inventory, total_reserved
        - **reservation** - reservation_id(PK), hotel_id, room_id, start_date, end_date, status, guest_id
    - **room_type_inventory**
        - νΈν…”μ λ¨λ“  κ°μ‹¤ μ ν•μ„ λ‹΄λ” ν…μ΄λΈ”
        - 2λ…„ μ΄λ‚΄μ λ¨λ“  λ―Έλ λ‚ μ§μ— λ€ν• κ°€μ© κ°μ‹¤ λ°μ΄ν„° μ§μ κ²°κ³Όλ¥Ό ν† λ€λ΅ λ°μ΄ν„°λ¥Ό λ―Έλ¦¬ λ§λ“¤μ–΄λ‘”λ‹¤.
        - μ‹κ°„μ νλ¦„μ— λ”°λΌ μƒλ΅ μ¶”κ°€ν•΄μ•Ό ν•λ” κ°μ‹¤ μ •λ³΄λ” λ§¤μΌ ν• λ²μ”© μΌκ΄„ μ‘μ—…μ„ λλ ¤ λ°μν•λ‹¤.
        - **total_inventory**: μ΄ κ°μ‹¤ μμ—μ„ μΌμ‹μ μΌλ΅ μ μ™Έν• κ°μ‹¤ μλ¥Ό λΊ€ κ°’ (μ‹¤μ  μμ•½ κ°€λ¥ν• κ°μ‹¤ μ)
        - **total_reserved**: μ§€μ •λ hotel_id, room_type_id, dateμ— μμ•½λ λ¨λ“  κ°μ‹¤ μ
- **λ°μ΄ν„° μ €μ¥ μ©λ‰ μ¶”μ •**
    - 5,000κ°μ νΈν…”, κ° νΈν…”μ—λ” 20κ°μ κ°μ‹¤ μ ν•μ΄ μλ‹¤κ³  κ°€μ •
        
        β†’ 5,000 * 20 * 2λ…„ * 365μΌ = 7,300λ§ κ°
        
        β†’ λ°μ΄ν„° μ–‘μ΄ λ§μ§„ μ•μΌλ‚ SPOF λ°©μ§€, κ³ κ°€μ©μ„± λ‹¬μ„±μ„ μ„ν•΄ μ—¬λ¬ AZμ— λ°μ΄ν„°λ¥Ό λ³µμ ν•΄λ‘”λ‹¤.
        

### μμ•½ λ°μ΄ν„°κ°€ λ‹¨μΌ DBμ— λ‹΄κΈ°μ— λ„λ¬΄ ν¬λ©΄ μ–΄λ–»κ² ν•΄μ•Όν• κΉ?

- ν„μ¬ λ° ν–¥ν›„ μμ•½ λ°μ΄ν„°λ§ μ €μ¥ν•λ‹¤.
    - μμ•½ μ΄λ ¥μ€ μμ£Ό μ ‘κ·Όν•μ§€ μ•μΌλ―€λ΅ μ•„μΉ΄μ΄λΉ™ν•κ±°λ‚ cold storageλ΅ μ΄λ™ν•λ‹¤.
- λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μƒ¤λ”©ν•λ‹¤.
    - hotel_idλ¥Ό μƒ¤λ”© ν‚¤λ΅, λ°μ΄ν„°λ” hash(hotel_id % number_of_servers)λ΅ μƒ¤λ”©ν•λ‹¤.

## λ™μ‹μ„± λ¬Έμ 

### μ‹λ‚λ¦¬μ¤ 1) κ°™μ€ μ‚¬μ©μκ°€ μμ•½ λ²„νΌμ„ μ—¬λ¬ λ² ν΄λ¦­ν•λ‹¤.

- ν΄λΌμ΄μ–ΈνΈ μΈ΅ κµ¬ν„
    - μ”μ²­ μ „μ†΅ ν›„ μμ•½ λ²„νΌμ„ disabled μ²λ¦¬ν•λ‹¤.
        
        β†’ μ‚¬μ©μκ°€ μ°νν•  μ μκΈ° λ•λ¬Έμ— μ•μ •μ μΈ λ°©λ²•μ€ μ•„λ‹λ‹¤.
        
- λ©±λ“± API (λ‡ λ²μ„ νΈμ¶ν•΄λ„ κ°™μ€ κ²°κ³Όλ¥Ό λ‚΄λ” API)
    - μμ•½ API μ”μ²­μ— λ©±λ“± ν‚¤λ¥Ό μ¶”κ°€ν•λ‹¤.
    - flow
        - μ μ €κ°€ μμ•½ λ‚΄μ© μ…λ ¥ ν›„ β€λ‹¤μβ€™ λ²„νΌμ„ ν΄λ¦­ν•λ©΄ μμ•½ μ£Όλ¬Έμ„ μƒμ„±
            - μ΄ λ• reservation_id(λ©±λ“±ν‚¤)κ°€ μƒμ„±λλ‹¤.
        - μ μ €κ°€ μμ•½ μ£Όλ¬Έμ„ λ‚΄μ©μ„ κ²€ν† ν•κ³  μμ•½ μ”μ²­μ„ λ³΄λ‚Έλ‹¤.
            - μ΄ μ”μ²­μ— reservation_id(λ©±λ“±ν‚¤)λ¥Ό λ‹΄μ•„ λ³΄λ‚Έλ‹¤.
            - reservation_idλ” μμ•½ ν…μ΄λΈ”μ PKμ΄λ―€λ΅ μƒλ΅μ΄ λ μ½”λ“κ°€ μƒμ„±λμ§€ μ•μ•„ μ΄μ¤‘ μμ•½μ΄ λ¶κ°€ν•λ‹¤.

### μ‹λ‚λ¦¬μ¤ 2) μ—¬λ¬ μ‚¬μ©μκ°€ λ™μ‹μ— κ°™μ€ κ°μ‹¤μ— μμ•½ μ”μ²­μ„ λ³΄λ‚Έλ‹¤.

- **λ°©μ• 1) λΉ„κ΄€μ  λ½**
    - μ‚¬μ©μκ°€ λ μ½”λ“λ¥Ό κ°±μ‹ ν•λ ¤κ³  ν•λ” μκ°„ μ¦‰μ‹ λ½μ„ κ±Έμ–΄ λ™μ‹ μ—…λ°μ΄νΈλ¥Ό λ°©μ§€ν•λ‹¤.
    - λ™μΌν• λ μ½”λ“λ¥Ό κ°±μ‹ ν•λ ¤λ” λ‹¤λ¥Έ μ‚¬μ©μλ” λ½μ΄ ν•΄μ λ  λ•κΉμ§€ κΈ°λ‹¤λ ¤μ•Ό ν•λ‹¤.
    - MySQLμ—μ„λ” `SELECT β€¦ FOR UPDATE` κµ¬λ¬Έμ„ ν†µν•΄ λΉ„κ΄€μ  λ½μ„ κ±Έ μ μλ‹¤.
    - μ¥μ 
        - λ³€κ²½ μ¤‘μ΄κ±°λ‚ λ³€κ²½μ΄ λλ‚ λ°μ΄ν„°λ¥Ό κ°±μ‹ ν•λ” μΌμ„ λ°©μ§€ν•  μ μλ”°.
        - κµ¬ν„μ΄ μ‰½κ³  λ¨λ“  κ°±μ‹  μ—°μ‚°μ„ μ§λ ¬ν™”ν•μ—¬ μ¶©λμ„ λ§‰λ”λ‹¤.
    - λ‹¨μ 
        - μ—¬λ¬ λ μ½”λ“μ— λ½μ„ κ±Έλ©΄ deadlockμ΄ λ°μƒν•κΈ° μ‰½λ‹¤.
        - νΈλμ­μ…μ μλ…μ΄ κΈΈκ±°λ‚ λ§μ€ μ—”ν‹°ν‹°μ— κ΄€λ ¨λ κ²½μ° DB μ„±λ¥μ— μ‹¬κ°ν• μ•…μν–¥μ„ λΌμΉλ‹¤.
    
    β†’ κ²°κ³Όμ μΌλ΅ κ¶μ¥λμ§€ μ•λ” λ°©λ²•
    
- **λ°©μ• 2) λ‚™κ΄€μ  λ½**
    - μ—¬λ¬ μ‚¬μ©μκ°€ λ™μ‹μ— κ°™μ€ μμ›μ— κ°±μ‹  μ‹λ„ν•λ” κ²ƒμ„ ν—μ©ν•λ‹¤.
    - version number, timestamp λ‘ κ°€μ§€ λ°©λ²•μΌλ΅ κµ¬ν„ν•λ©°, version numberκ°€ λ” κ¶μ¥λλ‹¤.
    - flow
        - λ μ½”λ“ μμ • μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν•΄λ‹Ή λ μ½”λ“μ λ²„μ „ λ²νΈλ¥Ό μ½λ”λ‹¤.
        - λ μ½”λ“κ°€ κ°±μ‹ λ  λ• λ²„μ „ λ²νΈμ— 1μ„ λ”ν• λ‹¤μ DBμ— λ‹¤μ‹ κΈ°λ΅ν•λ‹¤.
        - μ΄ λ• μ ν¨μ„± κ²€μ‚¬λ¥Ό ν•΄μ„ λ‹¤μ λ²„μ „ λ²νΈκ°€ ν„μ¬ λ²„μ „ λ²νΈλ³΄λ‹¤ μ‘κ±°λ‚ κ°™μΌλ©΄ νΈλμ­μ…μ„ μ¤‘λ‹¨ν•λ‹¤.
    - μ¥μ 
        - λΉ„κ΄€μ  λ½λ³΄λ‹¤ λΉ λ¥΄λ‹¤.
        - DB μμ›μ— λ½μ„ κ±Έ ν•„μ”κ°€ μ—†μΌλ©°, λ°μ΄ν„° μΌκ΄€μ„± μ μ§€μ μ±…μ„μ€ μ• ν”λ¦¬μΌ€μ΄μ…μ— μλ‹¤.
        - λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μΉμ—΄ν•μ§€ μ•μ€ μƒν™©μ— μ ν•©ν•λ‹¤.
    - λ‹¨μ 
        - λ™μ‹μ„± μμ¤€μ΄ μ•„μ£Ό λ†’μΌλ©΄ μ„±λ¥μ΄ κΈ‰κ²©ν•κ² λ–¨μ–΄μ§„λ‹¤.
            - μ½μ„ λ•λ” μ—¬λ¬ μ‚¬μ©μκ°€ λ°μ΄ν„°λ¥Ό μ½μ§€λ§, μ‹¤μ λ΅ κ°±μ‹ μ— μ„±κ³µν•λ” ν΄λΌμ΄μ–ΈνΈλ” ν•λ‚μ΄κΈ° λ•λ¬Έ
            - μ μ € κ²½ν— μΈ΅λ©΄μ—μ„λ„ μΆ‹μ§€ λ»ν•¨
- **λ°©μ• 3) λ°μ΄ν„°λ² μ΄μ¤ μ μ•½ μ΅°κ±΄**
    - λ‚™κ΄€μ  λ½κ³Ό λΉ„μ·ν• λ°©μ‹μ΄μ§€λ§, μ μ•½ μ΅°κ±΄μ„ DBμ— κ±Έμ–΄λ‘”λ‹¤.
    - μ¥μ 
        - κµ¬ν„μ΄ μ‰½κ³ , λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μΉμ—΄ν•μ§€ μ•μ€ μƒν™©μ— μ ν•©ν•λ‹¤.
    - λ‹¨μ 
        - λ‚™κ΄€μ  λ½μ λ‹¨μ κ³Ό λ™μΌν•λ‹¤.
        - DB μ μ•½ μ΅°κ±΄μ€ μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“μ™€ λ‹¬λΌμ„ λ²„μ „μ„ ν†µμ ν•κΈ° μ–΄λ µλ‹¤.
        - DBκ°€ λ³€κ²½λλ©΄ κµ¬ν„μ΄ λ³€κ²½λμ–΄μ•Ό ν•λ‹¤.
    
    β†’ νΈν…” μμ•½μ κ²½μ° λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μ‹¬ν•μ§€ μ•μΌλ―€λ΅(λ‚®μ€ QPS) μΆ‹μ€ μ„ νƒμ§€μ΄λ‹¤.
    

## μ‹μ¤ν…μ κ·λ¨ ν™•μ¥

- μ‹μ¤ν… λ¶€ν•κ°€ λ†’μ•„μ§„λ‹¤λ©΄ λ¬΄μ—‡μ΄ λ³‘λ©μ΄ λ  μ§€ μ΄ν•΄ν•λ” κ²ƒμ΄ μ¤‘μ”ν–λ‹¤.
- λ¨λ“  μ„λΉ„μ¤λ” MSAλ΅ λ¶„λ¦¬λμ–΄ μκ³ , λ¬΄μƒνƒ μ„λΉ„μ¤μ΄λ―€λ΅ μ„λΉ„μ¤μ μ¤μΌ€μΌλ§μ€ μ‰½κ² κ°€λ¥ν•λ‹¤.
- λ°μ΄ν„°λ² μ΄μ¤λ” λ‹¨μν μ„λ²„λ¥Ό λλ¦¬λ” κ²ƒλ§μΌλ΅ μ„±λ¥ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μ—†λ‹¤.

### λ°μ΄ν„°λ² μ΄μ¤ μƒ¤λ”©

- hotel_idλ¥Ό μƒ¤λ”© μ΅°κ±΄μΌλ΅ μ‚¬μ©ν•λ‹¤.
- QPSκ°€ 30,000μ΄λΌκ³  κ°€μ •ν–μ„ λ• DBλ¥Ό 16κ°μ μƒ¤λ“λ΅ λ¶„μ‚°ν•λ” μ‚¬λ΅€
    
    β†’ `30,000 / 16 = 1,875QPS` μ²λ¦¬
    

### μΊμ‹

- νΈν…” μ”μ—¬ κ°μ‹¤ λ°μ΄ν„°λ” ν„μ¬, λ―Έλμ λ°μ΄ν„°λ§ μ¤‘μ”ν•λ‹¤.
    
    β†’ κ³Όκ±° λ°μ΄ν„°λ” μλ™μΌλ΅ μ†λ©Έλλ„λ΅ TTLμ„ μ„¤μ •ν•λ‹¤.
    
    β†’ Redisλ” TTLκ³Ό LRU μΊμ‹ κµμ²΄ μ •μ±…μ„ μ‚¬μ©ν•μ—¬ λ©”λ¨λ¦¬λ¥Ό μµμ μΌλ΅ ν™μ©ν•λ‹¤.
    
- λ³€κ²½λ Flow
    - μμ•½ μ„λΉ„μ¤ β†’ μ”μ—¬ κ°μ‹¤ μΊμ‹
    - μμ•½ μ„λΉ„μ¤ β†’ DBμ— μ”μ—¬ κ°μ‹¤ μ κ°±μ‹ 
    - DB β†’ μ”μ—¬ κ°μ‹¤ μΊμ‹λ΅ λ°μ΄ν„° λΉ„λ™κΈ° κ°±μ‹ 
- μ¥μ 
    - μ½κΈ° μ§μλ¥Ό μΊμ‹κ°€ μ²λ¦¬ν•λ―€λ΅ DB λ¶€ν•κ°€ μ¤„κ³ , μΊμ‹λ” λ©”λ¨λ¦¬μ—μ„ μ‹¤ν–‰λλ―€λ΅ λΉ λ¥΄λ‹¤.
- λ‹¨μ 
    - DBμ™€ μΊμ‹ μ‚¬μ΄μ λ°μ΄ν„° μΌκ΄€μ„± λ¬Έμ κ°€ λ°μƒν•  μ μλ‹¤.
    - μµμΆ…μ μΌλ΅ DBμ—μ„ μ ν¨μ„± μ²΄ν¬λ¥Ό ν•λ”λΌλ„ μ‚¬μ©μ κ²½ν—μ—λ” μ• μΆ‹μ€ μν–¥μ„ λ―ΈμΉ  μ μλ‹¤.

**π”¥Β DBμ™€ μΊμ‹ μ‚¬μ΄μ λ°μ΄ν„° μΌκ΄€μ„± λ¬Έμ **

- μΌλ°μ μΈ λ°μ΄ν„° λ³€κ²½ Flow
    - μ”μ—¬ κ°μ‹¤ μλ¥Ό μ§μν•μ—¬ μ¶©λ¶„ν•μ§€ ν™•μΈν•λ‹¤ β†’ μΊμ‹μ—μ„ μ΅°ν
    - μ”μ—¬ κ°μ‹¤ λ°μ΄ν„°λ¥Ό κ°±μ‹ ν•λ‹¤. (DB κ°±μ‹  β†’ μΊμ‹ κ°±μ‹ (λΉ„λ™κΈ°))
        - μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μν–‰ν•κ±°λ‚, CDC λ§¤μ»¤λ‹μ¦μ„ μ΄μ©ν•λ‹¤.
        - μ΄ μ°°λ‚μ μκ°„ λλ” κ°±μ‹  κ³Όμ •μ—μ„ μ¤λ¥κ°€ λ°μƒν•  κ²½μ° λ°μ΄ν„° μΌκ΄€μ„± λ¬Έμ κ°€ λ°μƒν•  μ μλ‹¤.
- μμ•½ μ‹λ„ μ‹ μµμΆ…μ μΌλ΅ DBμ—μ„ μ”μ—¬ κ°μ‹¤μ„ ν™•μΈν•λ„λ΅ ν•΄μ„ λ¬Έμ λ¥Ό ν•΄κ²°ν•μ! (μ΄μ„ μΆ..)

### MSAμ—μ„μ λ°μ΄ν„° μΌκ΄€μ„± λ¬Έμ μ— λ€ν• ν•΄κ²° λ°©μ•

- μ§€κΈκΉμ§€ μ‚΄ν΄λ³Έ μ‹μ¤ν…μ€ **ν•μ΄λΈλ¦¬λ“ μ ‘κ·Όλ²•**
    - μ—¬λ¬ μ‹μ¤ν…μ—μ„ λ™μΌν• DBμ— μ ‘κ·Όν•λ‹¤.
- ν•μ§€λ§ μμν• MSAλΌλ©΄ κ° MSAκ°€ λ…μμ μΈ DBλ¥Ό κ°–μ¶”κ³  μμ–΄μ•Ό ν•λ‹¤.
    - λ…Όλ¦¬μ μΌλ΅ ν•λ‚μ μ›μμ  μ—°μ‚°μ΄ μ—¬λ¬ λ°μ΄ν„°λ² μ΄μ¤μ— κ±Έμ³ μ‹¤ν–‰λλ” μΌμ„ ν”Όν•  μ μ—†λ‹¤.
        - ν•λ‚μ νΈλμ­μ…μΌλ΅ λ°μ΄ν„° μΌκ΄€μ„±μ„ λ³΄μ¦ν•λ” κΈ°λ²•μ„ μ‚¬μ©ν•  μ μ—†λ‹¤λ” λ»μ΄λ‹¤.

- **λ°©μ• 1) 2-phase commit (2PC)**
    - **2PC** : μ—¬λ¬ λ…Έλ“μ— κ±ΈμΉ μ›μμ  νΈλμ­μ… μ‹¤ν–‰μ„ λ³΄μ¦ν•λ” λ°μ΄ν„°λ² μ΄μ¤ ν”„λ΅ν† μ½
    - λ¨λ“  λ…Έλ“κ°€ μ„±κ³µ or μ‹¤ν¨ λ‘ μ¤‘ ν•λ‚λ΅ νΈλμ­μ…μ΄ λ§λ¬΄λ¦¬λλ„λ΅ λ³΄μ¦ν•λ‹¤.
    - blocking-protocolμ΄λ―€λ΅, ν• λ…Έλ“μ— μ¥μ• κ°€ λ°μƒν•λ©΄ ν•΄λ‹Ή μ¥μ• κ°€ λ³µκµ¬λ  λ•κΉμ§€ μ§„ν–‰μ΄ μ¤‘λ‹¨λλ‹¤. (μ„±λ¥ low)
- **λ°©μ• 2) Saga Pattern**
    - κ° λ…Έλ“μ— κµ­μ§€μ μΌλ΅ λ°μƒν•λ” νΈλμ­μ…μ„ ν•λ‚λ΅ μ—®μ€ κ²ƒ
    - κ°κ°μ νΈλμ­μ…μ΄ μ™„λ£λλ©΄ λ‹¤μ νΈλμ­μ…μ„ μ‹μ‘ν•λ” νΈλ¦¬κ±°λ΅ μ“°μΌ λ©”μ‹μ§€λ¥Ό λ§λ“¤μ–΄ λ³΄λ‚Έλ‹¤.
    - μ–΄λ ν• νΈλμ­μ…μ΄λΌλ„ μ‹¤ν¨ν•λ©΄ κ·Έ μ΄μ „ νΈλμ­μ…μ„ μ „λ¶€ λλλ¦¬λ” νΈλμ­μ…λ“¤μ„ μμ°¨μ μΌλ΅ μ‹¤ν–‰ν•λ‹¤.

# 4λ‹¨κ³„. λ§λ¬΄λ¦¬

- LGTM π€
